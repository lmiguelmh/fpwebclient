"use strict";require("core-js/modules/es6.promise");require("core-js/modules/es6.object.to-string");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var vars=require("./vars");var messages=require("./messages");var URIUtils=require("./URIUtils");var SimpleNativeApplication=require("./SimpleNativeApplication");var PORT=42001;var CHILD="read.config.exe";var ReadConfigNativeApp=function(){function ReadConfigNativeApp(){_classCallCheck(this,ReadConfigNativeApp)}_createClass(ReadConfigNativeApp,null,[{key:"readJSON",value:function readJSON(path){return new Promise(function(resolve,reject){try{var localAppUrl="ws://localhost:".concat(PORT,"/");var result="";var errorResult=false;var nativeApplication=new SimpleNativeApplication(function(){nativeApplication.send(path)},function(message){result+=message+"\n"},function(){if(!errorResult){try{resolve(JSON.parse(result))}catch(e){reject(e)}}else{reject(result)}},function(error){errorResult=true;result=error});nativeApplication.connect(localAppUrl);setTimeout(function(){if(!nativeApplication.connection){var taskTrayArgs={port:PORT,child:CHILD};var uri=URIUtils.buildUri(vars.URI_PROTOCOL,"fp",taskTrayArgs);URIUtils.launch(uri)}},500)}catch(e){reject(e)}})}}]);return ReadConfigNativeApp}();global.ReadConfigNativeApp=ReadConfigNativeApp;module.exports=ReadConfigNativeApp;